# Ubuntu虚拟机快速设置指南

## 重要提示

**本指南主要用于测试多人协作白板的网络通信功能。**

- **虚拟机版本的限制**：
  - 主要用于测试协作绘图的网络连接和数据同步功能
  - 触摸绘图功能在虚拟机上可能无法完全工作（需要framebuffer设备）
  - 无法体验完整的触摸绘图体验

- **完整功能体验**：
  - 要体验完整的协作绘图功能（包括触摸绘图、实时绘制等），请使用两个相同型号的开发板（GEC6818）
  - 两个开发板分别作为主机和客机，可以完整体验所有功能

## 快速开始

### 1. 安装依赖

```bash
sudo apt update
sudo apt install -y build-essential gcc make libsdl2-dev git
```

### 2. 配置SDL驱动（可选，Makefile已通过-D参数设置）

**方式1（推荐）**: 使用Makefile的默认配置，无需修改文件

**方式2**: 手动编辑 `lv_drv_conf.h`，找到以下部分并修改：

```c
/* SDL based drivers for display, mouse, mousewheel and keyboard*/
#ifndef USE_SDL
# define USE_SDL 1  // 改为1
#endif

#if USE_SDL || USE_SDL_GPU
#  define SDL_HOR_RES     800  // 改为800（匹配GEC6818）
#  define SDL_VER_RES     480  // 改为480（匹配GEC6818）
```

### 3. 编译

```bash
# 清理之前的编译文件
make clean

# 编译项目
make
```

**注意**：根目录的 `Makefile` 默认就是Ubuntu虚拟机版本，直接使用 `make clean` 和 `make` 即可。

### 双端编译说明

如果你需要在开发板和虚拟机两个环境中都进行编译：

**开发板端（GEC6818）**：
```bash
# 清理
make -f Makefile.gec6818 clean

# 编译
make -f Makefile.gec6818

# 生成的可执行文件：demo
```

**虚拟机端（Ubuntu）**：
```bash
# 清理
make clean

# 编译
make

# 生成的可执行文件：demo_ubuntu
```

**提示**：
- 两个环境的编译产物互不干扰（开发板使用 `build/` 目录，虚拟机使用 `build_ubuntu/` 目录）
- 可以同时保留两个环境的编译产物，方便在不同环境中测试

### 4. 运行

**完整版本**（包含所有功能）：
```bash
./demo_ubuntu
```

**简化版本**（仅测试协作绘图功能，窗口更大）：
```bash
# 编译时已经使用简化版本（main_collab_test.c）
./demo_ubuntu
```

**注意**：简化版本会：
- 直接显示触摸绘图界面（跳过屏保和密码锁）
- 窗口大小为 1600x960（SDL_ZOOM=2）
- 只包含协作绘图相关功能

## 注意事项

- **虚拟机版本的主要用途**: 
  - 主要用于测试多人协作白板的网络通信功能
  - 验证巴法云TCP协议的连接和数据同步
  - 调试网络相关的代码

- **功能限制**: 
  - 触摸绘图功能在虚拟机上可能无法完全工作（需要framebuffer设备）
  - 无法体验完整的触摸绘图体验
  - UI界面和协作绘图的网络部分可以正常测试

- **完整功能体验**: 
  - 要体验完整的协作绘图功能，请使用两个相同型号的开发板（GEC6818）
  - 两个开发板分别作为主机和客机，可以完整体验所有功能

- **鼠标操作**: 使用鼠标左键点击和拖拽来模拟触摸操作

## 测试协作绘图

**重要提示**：虚拟机版本主要用于测试网络通信功能。要体验完整的协作绘图功能，请使用两个相同型号的开发板（GEC6818）。

### 方式1：两个GEC6818开发板（推荐 - 完整功能）

1. 在两个GEC6818开发板上分别运行 `./demo`
2. 在一个开发板上点击"连接协作"按钮（主机模式）
3. 在另一个开发板上点击"加入协作"按钮（客机模式）
4. 在两个开发板上进行触摸绘图，观察实时同步效果
5. **这是体验完整功能的最佳方式**

### 方式2：虚拟机 + GEC6818设备（网络功能测试）

1. 在Ubuntu虚拟机上运行 `./demo_ubuntu`
2. 在GEC6818设备上运行 `./demo`
3. 在虚拟机中点击"连接协作"按钮（主机模式）
4. 在GEC6818设备上点击"加入协作"按钮（客机模式）
5. 测试网络连接和数据同步（虚拟机端可能无法完整体验触摸绘图）

### 方式3：两个虚拟机实例（仅网络测试）

1. 打开两个终端窗口
2. 分别运行 `./demo_ubuntu`
3. 一个作为主机，一个作为客机
4. 测试网络连接和数据同步（无法体验完整的触摸绘图功能）

详细说明请参考 `UBUNTU_VM_TEST_GUIDE.md`。
